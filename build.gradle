apply plugin: "groovy"
apply plugin: "idea"
apply plugin: "eclipse"

repositories {
	mavenCentral()
}

dependencies {
	testCompile 'org.codehaus.groovy:groovy-all:2.1.2'
	testCompile 'junit:junit:4.11'
	testCompile 'cglib:cglib-nodep:2.2.2'
	testCompile 'org.objenesis:objenesis:1.3'
	testCompile('org.spockframework:spock-core:0.7-groovy-2.0') {
		exclude group: 'org.codehaus.groovy'
	}
	testCompile "org.mockito:mockito-all:1.9.5"
}

task removeSolutions << {
    String solutionRegex = $/(?sm)(// SNIPPET START).*?^(\s+// SNIPPET END)/$
    sourceSets.test.allSource.files.each { File sourceFile ->
        sourceFile.text = sourceFile.text.replaceAll(solutionRegex, '$1\n\t\torg.spockframework.util.Assert.fail("Remove me!")\n$2')
    }
    println "Solutions removed"
}
