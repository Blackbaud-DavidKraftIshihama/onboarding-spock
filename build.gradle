apply plugin: "groovy"
apply plugin: "idea"
apply plugin: "eclipse"

repositories {
	mavenCentral()
}

dependencies {
	testCompile 'org.codehaus.groovy:groovy-all:2.1.2'
	testCompile 'org.hamcrest:hamcrest-all:1.3'
	testCompile "org.mockito:mockito-core:1.9.5"
	testCompile 'junit:junit:4.11'
	testCompile 'cglib:cglib-nodep:2.2.2'
	testCompile 'org.objenesis:objenesis:1.3'
	testCompile('org.spockframework:spock-core:0.7-groovy-2.0') {
		exclude group: 'org.codehaus.groovy'
		exclude group: 'junit'
		exclude group: 'org.hamcrest'
	}
}

test.exclude 'com/example/gotchas/**'

task removeSolutions << {
	String solutionRegex = "// SNIPPET START[\\s\\S]*?// SNIPPET END"
	sourceSets.test.allSource.files.each { File sourceFile ->
		sourceFile.text = sourceFile.text.replaceAll(solutionRegex, 'org.spockframework.util.Assert.fail("Fix me!")')
	}
	println "Solutions removed"
}
